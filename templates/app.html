{% extends 'template.html' %}


{% block header %}

<!-- Passing data from Flask to Javascript -->
<script>
    const JS_CONTEXT = {{ js_context| tojson }};
</script>

<!-- Custom Array class -->
<script src="{{ url_for('static', filename='array.js') }}"></script>

<!-- Custom JS code -->
<script src="{{ url_for('static', filename='scripts.js') }}"></script>

<!-- Unity loader -->
<script src="static/Build/IBLMini-webgl.loader.js"></script>
{% endblock %}


{% block content %}

<div class="row">
    <div class="twelve columns">
        <h2>Session selector</h2>
    </div>
</div>

<div class="row">
    <div class="twelve columns">
        <p>Select to view one example probe insertion (gray) out of the hundreds recorded across all mice (white),
            either by clicking on the brain or by selecting its unique identifier (PID).
        </p>
    </div>
</div>

<!-- FIRST ROW -->
<div class="row">
    <!-- UNITY -->
    <div class="eight columns">
        <canvas id="unity-canvas"></canvas>
    </div>

    <!-- SESSION DETAILS -->
    <div class="four columns">

        <!-- SESSION DROPDOWN -->
        <select id="sessionSelector" class="u-full-width">
            {% for session in sessions %}
            <option value="{{ session.pid }}">PID {{ session.pid[:8] }}</option>
            {% endfor %}
        </select>

        <div id="sessionDetails">
        </div>
    </div>
</div>


<!-- SESSION OVERVIEW -->
<div class="row">
    <div class="twelve columns">
        <h2>Session overview</h2>
    </div>
</div>

<div class="row">
    <div class="twelve columns">
        <p>Glimpse over example informative features computed on either the electrophysiology or behavior signals
            throughout the whole session duration.</p>

        <p> Observe the differences in the raw ephys signals (e.g. RMS of the high-frequency AP signal ; or power in the
            delta band of the LFP) recorded across the depth of the probe, whose recording channels span multiple brain
            regions.
        </p>

        <p>
            Similarly, assess the distribution of multi-units versus single good clusters, or properties of single
            clusters along the probe (e.g. firing rate).
        </p>
    </div>
</div>




<!-- SESSION PLOTS -->
<div class="row">
    <!-- Session overview plot -->
    <div class="twelve columns">
        <img id="sessionPlot">
    </div>
</div>

<div class="row">
    <div class="twelve columns">
        <p>Get insights on the behavior performance thanks to psychometric curves, chronometric functions or reaction
            time distribution across the recording session.</p>
    </div>
</div>


<!-- TRIAL -->
<div class="row">
    <div class="twelve columns">
        <h2>Single trial overview</h2>
    </div>
</div>

<div class="row">
    <div class="twelve columns">
        <p>Select a trial from the dropdown menu to see its associated parameters and outcome. Notice its position
            within the recording, and the pattern of ephys activity around important behavioral events.</p>
    </div>
</div>


<div class="row">
    <!-- Trial selector -->
    <div class="three columns">

        <!-- Select -->
        <select size="15" id="trialSelector" class="u-full-width multiple">
        </select>

        <!-- Arrow button for navigation -->
        <div class="buttonNav">
            <div>
                <button class="trialLeft" onclick="arrowButton('trialSelector', -1);">&lt;</button>
                <button class="trialRight" onclick="arrowButton('trialSelector', +1);">&gt;</button>
            </div>
        </div>
    </div>

    <!-- Trial details -->
    <div class="nine columns" id="trialDetails">
    </div>
</div>


<!-- TRIAL PLOTS -->
<div>
    <!-- Trial raster plot -->
    <div class="row"></div>
        <div class="twelve columns">
            <img id="trialPlot">
        </div>
    </div>
    <!-- Placeholder for unity -->
    <div class="row">
        <div class="twelve columns">
            <canvas id="placeholder-canvas"></canvas>
        </div>
    </div>
</div>


<!-- CLUSTER -->
<div class="row">
    <div class="twelve columns">
        <h2>Single cluster overview</h2>
    </div>
</div>

<div class="row">
    <div class="twelve columns">
        <p>Select a good cluster from the dropdown menu to visualize its properties.</p>
    </div>
</div>


<div class="row">
    <!-- Cluster selector -->
    <div class="three columns">

        <!-- Select -->
        <select size="15" id="clusterSelector" class="u-full-width multiple">
        </select>

        <!-- Arrow button for navigation -->
        <div class="buttonNav">
            <div>
                <button class="clusterLeft" onclick="arrowButton('clusterSelector', -1);">&lt;</button>
                <button class="clusterRight" onclick="arrowButton('clusterSelector', +1);">&gt;</button>
            </div>
        </div>
    </div>

    <!-- Cluster details -->
    <div class="nine columns" id="clusterDetails">
    </div>

</div>


<!-- CLUSTER PLOTS -->
<div class="row">
    <div class="twelve columns">
        <!-- Cluster overview plot -->
        <img id="clusterPlot">
    </div>
</div>

{% endblock %}
